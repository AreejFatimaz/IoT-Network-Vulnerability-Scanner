# vulnerability_fetcher.py
import requests

# Function to get CVE details for a given device OS
def fetch_cves(device_os):
    url = f"https://cve.circl.lu/api/search/{device_os}"
    response = requests.get(url)

    if response.status_code == 200:
        cves = response.json()
        if cves:
            print(f"Found {len(cves)} CVEs for {device_os}")
            for cve in cves:
                print(f"CVE-ID: {cve['id']}, Description: {cve['summary']}")
        else:
            print(f"No CVEs found for {device_os}")
    else:
        print("Error fetching CVEs")
